<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD SQL Map 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.uce.omg.sso.dao.portal.IPortalUserMenuDao">
	
	<!-- 通过UserMenu的empCode和orgCode条件查询UserMenur的permissionId集合 -->
	<select id="findUserMenuByEmpCodeAndOrgCode" parameterType="cn.uce.omg.sso.entity.portal.PortalUserMenu" resultType="java.lang.Long">
		SELECT OMG_PORTAL_USER_MENU.PERMISSION_ID FROM OMG_PORTAL_USER_MENU
		WHERE 1 = 1 
		<if test="empCode != null and empCode != '' "> AND OMG_PORTAL_USER_MENU.EMP_CODE = #{empCode}</if>
		<if test="orgCode != null and orgCode != '' "> AND OMG_PORTAL_USER_MENU.ORG_CODE = #{orgCode}</if>
		ORDER BY SORT ASC
	</select>
	
	<delete id="deleteUserMenuByEmpAndOrgAndPerId" parameterType="java.util.Map">
		DELETE FROM OMG_PORTAL_USER_MENU WHERE EMP_CODE = #{empCode} and ORG_CODE = #{orgCode} 
		<foreach item="item" collection="permissionIds" open=" AND PERMISSION_ID IN (" separator="," close=")">
		#{item}
		</foreach>
		
	</delete>
	<delete id="deleteUserMenuByEmpAndOrg" parameterType="java.util.Map">
		DELETE FROM OMG_PORTAL_USER_MENU WHERE EMP_CODE = #{empCode} and ORG_CODE = #{orgCode} 
	</delete>
	<delete id="deleteUserMenuByParam" parameterType="java.util.Map">
		DELETE FROM OMG_PORTAL_USER_MENU WHERE EMP_CODE = #{empCode} and ORG_CODE = #{orgCode} and PERMISSION_ID = #{permissionId}
	</delete>
</mapper>
